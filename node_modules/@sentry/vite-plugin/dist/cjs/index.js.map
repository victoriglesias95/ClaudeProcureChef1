{"version":3,"file":"index.js","sources":["../../src/index.ts"],"sourcesContent":["import {\n  sentryUnpluginFactory,\n  Options,\n  createRollupReleaseInjectionHooks,\n  createRollupModuleMetadataInjectionHooks,\n  createRollupDebugIdInjectionHooks,\n  createRollupDebugIdUploadHooks,\n  SentrySDKBuildFlags,\n  createRollupBundleSizeOptimizationHooks,\n  createComponentNameAnnotateHooks,\n  Logger,\n} from \"@sentry/bundler-plugin-core\";\nimport { UnpluginOptions } from \"unplugin\";\n\nfunction viteReleaseInjectionPlugin(injectionCode: string): UnpluginOptions {\n  return {\n    name: \"sentry-vite-release-injection-plugin\",\n    // run `post` to avoid tripping up @rollup/plugin-commonjs when cjs is used\n    // as we inject an `import` statement\n    enforce: \"post\" as const, // need this so that vite runs the resolveId hook\n    vite: createRollupReleaseInjectionHooks(injectionCode),\n  };\n}\n\nfunction viteComponentNameAnnotatePlugin(ignoredComponents?: string[]): UnpluginOptions {\n  return {\n    name: \"sentry-vite-component-name-annotate-plugin\",\n    enforce: \"pre\" as const,\n    vite: createComponentNameAnnotateHooks(ignoredComponents),\n  };\n}\n\nfunction viteDebugIdInjectionPlugin(): UnpluginOptions {\n  return {\n    name: \"sentry-vite-debug-id-injection-plugin\",\n    vite: createRollupDebugIdInjectionHooks(),\n  };\n}\n\nfunction viteModuleMetadataInjectionPlugin(injectionCode: string): UnpluginOptions {\n  return {\n    name: \"sentry-vite-module-metadata-injection-plugin\",\n    vite: createRollupModuleMetadataInjectionHooks(injectionCode),\n  };\n}\n\nfunction viteDebugIdUploadPlugin(\n  upload: (buildArtifacts: string[]) => Promise<void>,\n  logger: Logger,\n  createDependencyOnBuildArtifacts: () => () => void\n): UnpluginOptions {\n  return {\n    name: \"sentry-vite-debug-id-upload-plugin\",\n    vite: createRollupDebugIdUploadHooks(upload, logger, createDependencyOnBuildArtifacts),\n  };\n}\n\nfunction viteBundleSizeOptimizationsPlugin(\n  replacementValues: SentrySDKBuildFlags\n): UnpluginOptions {\n  return {\n    name: \"sentry-vite-bundle-size-optimizations-plugin\",\n    vite: createRollupBundleSizeOptimizationHooks(replacementValues),\n  };\n}\n\nconst sentryUnplugin = sentryUnpluginFactory({\n  releaseInjectionPlugin: viteReleaseInjectionPlugin,\n  componentNameAnnotatePlugin: viteComponentNameAnnotatePlugin,\n  debugIdInjectionPlugin: viteDebugIdInjectionPlugin,\n  moduleMetadataInjectionPlugin: viteModuleMetadataInjectionPlugin,\n  debugIdUploadPlugin: viteDebugIdUploadPlugin,\n  bundleSizeOptimizationsPlugin: viteBundleSizeOptimizationsPlugin,\n});\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport const sentryVitePlugin: (options?: Options) => any = sentryUnplugin.vite;\n\nexport type { Options as SentryVitePluginOptions } from \"@sentry/bundler-plugin-core\";\nexport { sentryCliBinaryExists } from \"@sentry/bundler-plugin-core\";\n"],"names":["viteReleaseInjectionPlugin","injectionCode","name","enforce","vite","createRollupReleaseInjectionHooks","viteComponentNameAnnotatePlugin","ignoredComponents","createComponentNameAnnotateHooks","viteDebugIdInjectionPlugin","createRollupDebugIdInjectionHooks","viteModuleMetadataInjectionPlugin","createRollupModuleMetadataInjectionHooks","viteDebugIdUploadPlugin","upload","logger","createDependencyOnBuildArtifacts","createRollupDebugIdUploadHooks","viteBundleSizeOptimizationsPlugin","replacementValues","createRollupBundleSizeOptimizationHooks","sentryUnplugin","sentryUnpluginFactory","releaseInjectionPlugin","componentNameAnnotatePlugin","debugIdInjectionPlugin","moduleMetadataInjectionPlugin","debugIdUploadPlugin","bundleSizeOptimizationsPlugin","sentryVitePlugin"],"mappings":";;;;;;AAcA,SAASA,0BAA0BA,CAACC,aAAqB,EAAmB;EAC1E,OAAO;AACLC,IAAAA,IAAI,EAAE,sCAAsC;AAC5C;AACA;AACAC,IAAAA,OAAO,EAAE,MAAe;AAAE;IAC1BC,IAAI,EAAEC,mDAAiC,CAACJ,aAAa,CAAA;GACtD,CAAA;AACH,CAAA;AAEA,SAASK,+BAA+BA,CAACC,iBAA4B,EAAmB;EACtF,OAAO;AACLL,IAAAA,IAAI,EAAE,4CAA4C;AAClDC,IAAAA,OAAO,EAAE,KAAc;IACvBC,IAAI,EAAEI,kDAAgC,CAACD,iBAAiB,CAAA;GACzD,CAAA;AACH,CAAA;AAEA,SAASE,0BAA0BA,GAAoB;EACrD,OAAO;AACLP,IAAAA,IAAI,EAAE,uCAAuC;IAC7CE,IAAI,EAAEM,mDAAiC,EAAC;GACzC,CAAA;AACH,CAAA;AAEA,SAASC,iCAAiCA,CAACV,aAAqB,EAAmB;EACjF,OAAO;AACLC,IAAAA,IAAI,EAAE,8CAA8C;IACpDE,IAAI,EAAEQ,0DAAwC,CAACX,aAAa,CAAA;GAC7D,CAAA;AACH,CAAA;AAEA,SAASY,uBAAuBA,CAC9BC,MAAmD,EACnDC,MAAc,EACdC,gCAAkD,EACjC;EACjB,OAAO;AACLd,IAAAA,IAAI,EAAE,oCAAoC;AAC1CE,IAAAA,IAAI,EAAEa,gDAA8B,CAACH,MAAM,EAAEC,MAAM,EAAEC,gCAAgC,CAAA;GACtF,CAAA;AACH,CAAA;AAEA,SAASE,iCAAiCA,CACxCC,iBAAsC,EACrB;EACjB,OAAO;AACLjB,IAAAA,IAAI,EAAE,8CAA8C;IACpDE,IAAI,EAAEgB,yDAAuC,CAACD,iBAAiB,CAAA;GAChE,CAAA;AACH,CAAA;AAEA,IAAME,cAAc,GAAGC,uCAAqB,CAAC;AAC3CC,EAAAA,sBAAsB,EAAEvB,0BAA0B;AAClDwB,EAAAA,2BAA2B,EAAElB,+BAA+B;AAC5DmB,EAAAA,sBAAsB,EAAEhB,0BAA0B;AAClDiB,EAAAA,6BAA6B,EAAEf,iCAAiC;AAChEgB,EAAAA,mBAAmB,EAAEd,uBAAuB;AAC5Ce,EAAAA,6BAA6B,EAAEV,iCAAAA;AACjC,CAAC,CAAC,CAAA;;AAEF;AACaW,IAAAA,gBAA4C,GAAGR,cAAc,CAACjB;;;;;;;;"}